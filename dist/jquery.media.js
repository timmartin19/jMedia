var Media;Media={convertToMedia:function(elements,options,beforeConversion,afterConversion){var settings,generatedHTMLElement;return elements.each(function(){var $this=$(this);options=options||{};settings=Media.private.getSettings(this,options);if(beforeConversion){beforeConversion(this,settings)}if(!settings.type){settings.type=Media.private.getExtensionType(settings.src.toLowerCase())}generatedHTMLElement=Media.private.generateHTMLPlayerElement(this,settings,settings.type);$this.replaceWith(generatedHTMLElement);if(afterConversion){afterConversion(this,generatedHTMLElement,settings,settings.type)}})},undo:function(elements){return elements.each(function(){var $this=this;var html=$this.data("media.origHTML");if(html){$this.replaceWith(html)}else{console.info("No original HTML was found on a media object.")}})}};$.fn.media=function(options,beforeConversion,afterConversion){if(options==="undo"){Media.undo(this)}else{Media.convertToMedia(this,options,beforeConversion,afterConversion)}};Media.defaults={standards:true,canUndo:true,width:400,height:400,autoplay:0,bgColor:"#FFFFFF",params:{wmode:"transparent"},attrs:{},flvKeyName:"file",flashvars:{},flashVersion:"7",expressInstaller:null,flvPlayer:"mediaplayer.swf",mp3Player:"mediaplayer.swf",silverlight:{inplaceInstallPrompt:"true",isWindowless:"true",framerate:"24",version:"0.9",onError:null,onLoad:null,initParams:null,userContext:null}};Media.defaults.players={flash:{name:"flash",title:"Flash",mimetype:"application/x-shockwave-flash",pluginspage:"http://www.adobe.com/go/getflashplayer",ieAttrs:{classid:"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000",type:"application/x-oleobject",codebase:"http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version="+Media.defaults.flashVersion}},quicktime:{name:"quicktime",title:"QuickTime",mimetype:"video/quicktime",pluginspage:"http://www.apple.com/quicktime/download/",ieAttrs:{classid:"clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B",codebase:"http://www.apple.com/qtactivex/qtplugin.cab"}},realplayer:{name:"real",title:"RealPlayer",mimetype:"audio/x-pn-realaudio-plugin",pluginspage:"http://www.real.com/player/",autoplayAttr:"autostart",ieAttrs:{classid:"clsid:CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA"}},winmedia:{name:"winmedia",title:"Windows Media",mimetype:"application/x-mplayer2",pluginspage:"http://www.microsoft.com/Windows/MediaPlayer/",autoplayAttr:"autostart",oUrl:"url",ieAttrs:{classid:"clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6",type:"application/x-oleobject"}},img:{name:"img",title:"Image"},iframe:{name:"iframe"},silverlight:{name:"silverlight"}};Media.defaults.extensions={flv:Media.defaults.players.flash,mp3:Media.defaults.players.flash,swf:Media.defaults.players.flash,aif:Media.defaults.players.quicktime,aiff:Media.defaults.players.quicktime,aac:Media.defaults.players.quicktime,au:Media.defaults.players.quicktime,bmp:Media.defaults.players.quicktime,gsm:Media.defaults.players.quicktime,mov:Media.defaults.players.quicktime,mid:Media.defaults.players.quicktime,midi:Media.defaults.players.quicktime,mpg:Media.defaults.players.quicktime,mpeg:Media.defaults.players.quicktime,mp4:Media.defaults.players.quicktime,m4a:Media.defaults.players.quicktime,psd:Media.defaults.players.quicktime,qt:Media.defaults.players.quicktime,qtif:Media.defaults.players.quicktime,qif:Media.defaults.players.quicktime,qti:Media.defaults.players.quicktime,snd:Media.defaults.players.quicktime,tif:Media.defaults.players.quicktime,tiff:Media.defaults.players.quicktime,wav:Media.defaults.players.quicktime,"3g2":Media.defaults.players.quicktime,"3gp":Media.defaults.players.quicktime,ra:Media.defaults.players.realplayer,ram:Media.defaults.players.realplayer,rm:Media.defaults.players.realplayer,rpm:Media.defaults.players.realplayer,rv:Media.defaults.players.realplayer,smi:Media.defaults.players.realplayer,smil:Media.defaults.players.realplayer,html:Media.defaults.players.iframe,pdf:Media.defaults.players.iframe,gif:Media.defaults.players.img,png:Media.defaults.players.img,jpg:Media.defaults.players.img,silverlight:Media.defaults.players.silverlight,asx:Media.defaults.players.winmedia,asf:Media.defaults.players.winmedia,avi:Media.defaults.players.winmedia,wma:Media.defaults.players.winmedia,wmv:Media.defaults.players.winmedia};function Player(extension){extension=extension[1];this.types=[];this.ieAttrs=[];this.name=null;this.isMSIE=/MSIE/.test(navigator.userAgent);this.isOldIE=this.isMSIE&&(/MSIE (6|7|8)\.0/.test(navigator.userAgent)||mode<9);var player=Media.defaults.extensions[extension];for(var key in player){if(player.hasOwnProperty(key)){this[key]=player[key]}}}Player.prototype.generate=function(element,options){var $tag=this.generateHTML(options);var $div=$("<div></div>");$div.append($tag);if(element.id){$div.attr("id",element.id)}if(element.class){$div.attr("class",element.class)}if(options.caption){$("<div>").appendTo($div).html(options.caption)}return $div};Player.prototype.generateHTML=function(options){var $tag;if(this.name==="iframe"){$tag=$("<iframe"+' width="'+options.width+'" height="'+options.height+'" >');$tag.attr("src",options.src)}else if(this.isOldIE){$tag=$("<object></object>");$tag=this.setAttributesOnElement($tag,options.attrs);if(this.ieAttrs){this.setAttributesOnElement($tag,this.ieAttrs)}$tag=this.setParameterTags($tag,options)}else if(options.standards){$tag=$("<object></object>");$tag.attr("type",this.mimetype);$tag=this.setHeightAndWidthTag($tag,options);if(options.src){$tag.attr("data",options.src)}if(this.isMSIE){$tag=this.setAttributesOnElement($tag,this.ieAttrs)}$tag=this.setParameterTags($tag,options);$tag.append($("<div><p><strong>"+this.title+" Required</strong></p><p>"+this.title+' is required to view this media. <a href="'+this.pluginspage+'">Download Here</a>.</p></div>'))}else{$tag=$("<embed></embed>");$tag=this.setHeightAndWidthTag($tag,options);if(options.src){$tag.attr("src",options.src)}$tag=this.setAttributesOnElement($tag,options.attrs);$tag=this.setAttributesOnElement($tag,this.eAttrs);$tag=this.setAttributesOnElement($tag,options.params)}return $tag};Player.prototype.setHeightAndWidthTag=function(tag,options){return tag.attr("width",options.width).attr("height",options.height)};Player.prototype.setAttributesOnElement=function($element,attrs){for(var key in attrs){if(attrs.hasOwnProperty(key)){$element.attr(key,attrs[key])}}return $element};Player.prototype.setParameterTags=function($tag,options){var parameters=[];var $parameter=$("<parameter/>");$parameter.attr("name",this.oUrl||"src").attr("value",options.src);parameters.push($parameter);for(key in options.params){if(options.params.hasOwnProperty(key)){$parameter=$("<parameter/>");$parameter.attr("name",key).attr("value",options.params[key]);parameters.push($parameter)}}for(var i=0;i<parameters.length;i++){$tag.append(parameters[i])}return $tag};Media.private={generateHTMLPlayerElement:function(element,options,extensionType){var p=new Player(extensionType);return p.generate(element,options)},getPlayerForType:function(extensionType){for(var player in Media.defaults.players){if(Media.defaults.players.hasOwnProperty(player)){if($.inArray(extensionType,Media.defaults.players[player].types)){return Media.defaults.players[player]}}}throw"A player for extension type "+extensionType+" was not found"},getSettings:function(element,options){var globalMediaSettings,meta,compiledOptions,$element;$element=$(element);options=options||{};meta=Media.private.getMetaSettings(element);globalMediaSettings=Media.defaults;compiledOptions=$.extend(globalMediaSettings,meta,options);if(typeof(compiledOptions.caption===undefined)){compiledOptions.caption=$element.text()}if(compiledOptions.src===undefined){compiledOptions.src=$element.attr("href")||$element.attr("src")}if(compiledOptions.src===undefined){throw"No source was defined on the element. Either href or src needs to be set on the element."}if(!compiledOptions.params){compiledOptions.params={}}return compiledOptions},getMetaSettings:function(element){var meta,attr,attrName;var dataName="data-";var $element=$(element);if($.metadata){meta=$element.metadata()}else if($.meta){meta=$element.data()}if(!meta){meta={}}meta.elementClass=element.className||"";if(!meta.width){meta.width=parseInt((meta.elementClass.match(/\bw:(\d+)/)||[])[1]||0,10)||parseInt((meta.elementClass.match(/\bwidth:(\d+)/)||[])[1]||0,10)}if(!meta.height){meta.height=parseInt((meta.elementClass.match(/\bh:(\d+)/)||[])[1]||0,10)||parseInt((meta.elementClass.match(/\bheight:(\d+)/)||[])[1]||0,10)}for(var i=0;i<element.attributes.length;i++){attr=element.attributes[i];attrName=$.trim(attr);if(attrName.slice(0,dataName.length)==dataName){meta[attrName]=attr.value}}return meta},getExtensionType:function(url){var regExp,extension;for(var key in Media.defaults.extensions){if(Media.defaults.extensions.hasOwnProperty(key)){regExp=new RegExp("\\.("+key+")\\b");extension=regExp.exec(url);if(extension){return extension}}}throw"No usable extension was found on the url: "+url}};